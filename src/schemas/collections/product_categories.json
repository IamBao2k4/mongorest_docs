{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Product Categories Junction Table",
  "description": "Many-to-many relationship between products and categories",
  "type": "object",
  "collection": "product_categories",
  "indexes": [
    { "fields": { "productId": 1, "categoryId": 1 }, "unique": true },
    { "fields": { "categoryId": 1 } },
    { "fields": { "productId": 1 } },
    { "fields": { "isPrimary": 1 } }
  ],
  "properties": {
    "_id": {
      "type": "string",
      "widget": "shortAnswer",
      "pattern": "^[0-9a-fA-F]{24}$",
      "description": "MongoDB ObjectId",
      "disabled": true
    },
    "productId": {
      "type": "string",
      "widget": "relation",
      "title": "Product",
      "pattern": "^[0-9a-fA-F]{24}$",
      "description": "Reference to product _id",
      "typeRelation": {
        "title": "Product",
        "entity": "products",
        "type": "n-1",
        "filter": {
          "combinator": "and",
          "rules": [],
          "id": "product-filter"
        }
      }
    },
    "categoryId": {
      "type": "string",
      "widget": "relation",
      "title": "Category",
      "pattern": "^[0-9a-fA-F]{24}$",
      "description": "Reference to category _id",
      "typeRelation": {
        "title": "Category",
        "entity": "categories",
        "type": "n-1",
        "filter": {
          "combinator": "and",
          "rules": [],
          "id": "category-filter"
        }
      }
    },
    "isPrimary": {
      "type": "boolean",
      "widget": "boolean",
      "title": "Primary Category",
      "default": false,
      "pattern": "^(true|false)$",
      "description": "Whether this is the primary category for the product",
      "appearance": "checkbox"
    },
    "sortOrder": {
      "type": "integer",
      "widget": "numberInput",
      "title": "Sort Order",
      "minimum": 0,
      "default": 0,
      "pattern": "^\\d+$",
      "description": "Display order within category",
      "format-data": "none"
    },
    "createdAt": {
      "type": "string",
      "widget": "dateTime",
      "title": "Created At",
      "format": "date-time",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$",
      "displayFormat": "yyyy/MM/dd HH:mm:ss",
      "formatDate": "date-time",
      "disabled": true,
      "field": "single",
      "mode": "dateTime"
    }
  },
  "required": ["productId", "categoryId"],
  "additionalProperties": false,
  "relationships": {
    "product": {
      "type": "belongsTo",
      "collection": "products",
      "foreignKey": "productId",
      "localField": "productId",
      "foreignField": "_id",
      "alias": "product",
      "description": "Product in this relationship",
      "widget": "relation",
      "typeRelation": {
        "type": "n-1",
        "entity": "products"
      }
    },
    "category": {
      "type": "belongsTo",
      "collection": "categories",
      "foreignKey": "categoryId",
      "localField": "categoryId",
      "foreignField": "_id",
      "alias": "category",
      "description": "Category in this relationship",
      "widget": "relation",
      "typeRelation": {
        "type": "n-1",
        "entity": "categories"
      }
    }
  }
}