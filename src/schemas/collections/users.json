{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Users Collection",
  "description": "User account information",
  "type": "object",
  "collection": "users",
  "indexes": [
    { "fields": { "email": 1 }, "unique": true },
    { "fields": { "createdAt": -1 } },
    { "fields": { "profile.country": 1, "status": 1 } },
    { "fields": { "name": "text", "email": "text" } }
  ],
  "plugins": [
    {
      "createdAt": true,
      "updatedAt": true,
      "timestamps": true,
      "softDelete": false
    }
  ],
  "properties": {
    "_id": {
      "type": "string",
      "widget": "shortAnswer",
      "pattern": "^[0-9a-fA-F]{24}$",
      "description": "MongoDB ObjectId",
      "disabled": true
    },
    "email": {
      "type": "string",
      "widget": "shortAnswer",
      "title": "Email Address",
      "format": "email",
      "pattern": "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",
      "description": "User email address",
      "format-data": "email"
    },
    "name": {
      "type": "string",
      "widget": "shortAnswer",
      "title": "Full Name",
      "minLength": 2,
      "maxLength": 100,
      "pattern": "^.{2,100}$",
      "description": "Full name",
      "format-data": "none"
    },
    "profile": {
      "type": "object",
      "title": "User Profile",
      "properties": {
        "age": {
          "type": "integer",
          "widget": "numberInput",
          "title": "Age",
          "minimum": 13,
          "maximum": 120,
          "pattern": "^\\d+$",
          "format-data": "none"
        },
        "country": {
          "type": "string",
          "widget": "select",
          "title": "Country",
          "enum": ["Vietnam", "Thailand", "Malaysia", "Singapore", "Indonesia", "Philippines"],
          "choices": [
            { "key": "Vietnam", "value": "Vietnam" },
            { "key": "Thailand", "value": "Thailand" },
            { "key": "Malaysia", "value": "Malaysia" },
            { "key": "Singapore", "value": "Singapore" },
            { "key": "Indonesia", "value": "Indonesia" },
            { "key": "Philippines", "value": "Philippines" }
          ],
          "allowNull": false
        },
        "interests": {
          "type": "array",
          "widget": "checkbox",
          "title": "Interests",
          "items": { 
            "type": "string",
            "pattern": "^.{0,50}$"
          },
          "maxItems": 10,
          "choices": [
            { "key": "technology", "value": "Technology" },
            { "key": "sports", "value": "Sports" },
            { "key": "music", "value": "Music" },
            { "key": "travel", "value": "Travel" },
            { "key": "food", "value": "Food" },
            { "key": "gaming", "value": "Gaming" },
            { "key": "movies", "value": "Movies" },
            { "key": "books", "value": "Books" },
            { "key": "fitness", "value": "Fitness" },
            { "key": "art", "value": "Art" }
          ],
          "layout": 0,
          "toggleAll": true
        },
        "avatar": {
          "type": "string",
          "widget": "file",
          "title": "Avatar",
          "format": "uri",
          "pattern": "^(https?://|/).*\\.(jpg|jpeg|png|gif|webp|svg)$",
          "meta": "Upload profile picture"
        }
      },
      "required": ["country"]
    },
    "role": {
      "type": "string",
      "widget": "select",
      "title": "Role",
      "enum": ["user", "admin", "moderator"],
      "default": "user",
      "choices": [
        { "key": "user", "value": "User" },
        { "key": "admin", "value": "Admin" },
        { "key": "moderator", "value": "Moderator" }
      ],
      "allowNull": false,
      "description": "User role for access control"
    },
    "status": {
      "type": "string",
      "widget": "select",
      "title": "Account Status",
      "enum": ["active", "inactive", "suspended"],
      "default": "active",
      "choices": [
        { "key": "active", "value": "Active" },
        { "key": "inactive", "value": "Inactive" },
        { "key": "suspended", "value": "Suspended" }
      ],
      "allowNull": false
    },
    "lastLogin": {
      "type": "string",
      "widget": "dateTime",
      "title": "Last Login",
      "format": "date-time",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$",
      "displayFormat": "yyyy/MM/dd HH:mm:ss",
      "formatDate": "date-time",
      "disabled": true,
      "field": "single",
      "mode": "dateTime"
    },
    "createdAt": {
      "type": "string",
      "widget": "dateTime",
      "title": "Created At",
      "format": "date-time",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$",
      "displayFormat": "yyyy/MM/dd HH:mm:ss",
      "formatDate": "date-time",
      "disabled": true,
      "field": "single",
      "mode": "dateTime"
    },
    "updatedAt": {
      "type": "string",
      "widget": "dateTime",
      "title": "Updated At",
      "format": "date-time",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$",
      "displayFormat": "yyyy/MM/dd HH:mm:ss",
      "formatDate": "date-time",
      "disabled": true,
      "field": "single",
      "mode": "dateTime"
    }
  },
  "required": ["email", "name", "profile", "role"],
  "additionalProperties": false
}