{
  "name": "mongorest-rbac",
  "version": "1.0.0",
  "description": "RBAC configuration for MongoRest",
  "collections": [
    {
      "collection_name": "users",
      "rbac_config": {
        "read": [
          {
            "user_role": "admin",
            "patterns": [
              { "id": { "type": "field" } },
              { "name": { "type": "field" } },
              { "email": { "type": "field" } },
              { "profile": { "type": "relation", "relate_collection": "user_profiles" } }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              { "id": { "type": "field" } },
              { "name": { "type": "field" } }
            ]
          }
        ],
        "write": [
          {
            "user_role": "admin",
            "patterns": [
              { "name": { "type": "field" } },
              { "email": { "type": "field" } }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "admin",
            "patterns": [
              { "id": { "type": "field" } }
            ]
          }
        ]
      }
    },
    {
      "collection_name": "posts",
      "rbac_config": {
        "read": [
          {
            "user_role": "admin",
            "patterns": [
              { "id": { "type": "field" } },
              { "title": { "type": "field" } },
              { "content": { "type": "field" } },
              { "author": { "type": "relation", "relate_collection": "users" } }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              { "id": { "type": "field" } },
              { "title": { "type": "field" } }
            ]
          }
        ],
        "write": [],
        "delete": []
      }
    },
    {
      "collection_name": "user_profiles",
      "rbac_config": {
        "read": [
          {
            "user_role": "admin",
            "patterns": [
              { "user_id": { "type": "field" } },
              { "bio": { "type": "field" } },
              { "avatar": { "type": "field" } }
            ]
          }
        ],
        "write": [],
        "delete": []
      }
    },
    {
      "collection_name": "product_categories",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              { "id": { "type": "field" } },
              { "name": { "type": "field" } },
              { "description": { "type": "field" } }
            ]
          }
        ],
        "write": [],
        "delete": []
      }
    }
  ],
  "rbac_features": {
    "pattern_syntax": {
      "field": "field_name",
      "relation": { "relation": "related_collection" },
      "all_fields": "*"
    },
    "permission_inheritance": {
      "enabled": true,
      "hierarchy": ["admin", "user", "guest"]
    },
    "dynamic_permissions": {
      "enabled": false,
      "context_aware": false,
      "runtime_evaluation": false
    }
  }
}