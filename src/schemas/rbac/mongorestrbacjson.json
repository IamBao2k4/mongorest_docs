{
  "name": "mongorest_rbac_config",
  "version": "3.1.0",
  "description": "RBAC configuration aligned with MongoREST collection schemas using HTTP methods",
  "collections": [
    {
      "collection_name": "products",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"sku": {"type": "string"}},
              {"name": {"type": "string"}},
              {"description": {"type": "string"}},
              {"category": {"type": "string"}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string"}}
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {"_id": {"type": "string"}},
              {"sku": {"type": "string"}},
              {"name": {"type": "string"}},
              {"description": {"type": "string"}},
              {"category": {"type": "string"}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"inventory.quantity": {"type": "number"}},
              {"images": {"type": "object"}},
              {"tags": {"type": "object"}},
              {"specifications": {"type": "object"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string"}},
              {"createdAt": {"type": "string"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"sku": {"type": "string"}},
              {"name": {"type": "string"}},
              {"description": {"type": "string"}},
              {"category": {"type": "string"}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"inventory": {"type": "object"}},
              {"images": {"type": "object"}},
              {"tags": {"type": "object"}},
              {"specifications": {"type": "object"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "admin",
            "patterns": [
              {"sku": {"type": "string", "pattern": "^SKU-[A-Z0-9]{6,10}$"}},
              {"name": {"type": "string", "minLength": 3, "maxLength": 200}},
              {"description": {"type": "string", "maxLength": 2000}},
              {"category": {"type": "string", "enum": ["electronics", "clothing", "food", "books", "home"]}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number", "min": 0, "max": 999999.99}},
              {"currency": {"type": "string", "enum": ["USD", "EUR", "VND", "GBP"]}},
              {"inventory": {"type": "object", "required": ["quantity", "warehouse"]}},
              {"images": {"type": "object"}},
              {"tags": {"type": "object"}},
              {"specifications": {"type": "object"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive", "draft"]}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "admin",
            "patterns": [
              {"sku": {"type": "string", "pattern": "^SKU-[A-Z0-9]{6,10}$"}},
              {"name": {"type": "string", "minLength": 3, "maxLength": 200}},
              {"description": {"type": "string", "maxLength": 2000}},
              {"category": {"type": "string", "enum": ["electronics", "clothing", "food", "books", "home"]}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number", "min": 0, "max": 999999.99}},
              {"currency": {"type": "string", "enum": ["USD", "EUR", "VND", "GBP"]}},
              {"inventory": {"type": "object", "required": ["quantity", "warehouse"]}},
              {"images": {"type": "object"}},
              {"tags": {"type": "object"}},
              {"specifications": {"type": "object"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive", "draft"]}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "user",
            "patterns": [
              {"ratings": {"type": "object"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"name": {"type": "string", "minLength": 3, "maxLength": 200}},
              {"description": {"type": "string", "maxLength": 2000}},
              {"price": {"type": "number", "min": 0, "max": 999999.99}},
              {"inventory.quantity": {"type": "number", "min": 0}},
              {"status": {"type": "string", "enum": ["active", "inactive", "draft"]}},
              {"tags": {"type": "object"}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"sku": {"type": "string"}},
              {"name": {"type": "string"}},
              {"description": {"type": "string"}},
              {"category": {"type": "string"}},
              {"subcategory": {"type": "string"}},
              {"price": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"inventory": {"type": "object"}},
              {"images": {"type": "object"}},
              {"tags": {"type": "object"}},
              {"specifications": {"type": "object"}},
              {"ratings": {"type": "object"}},
              {"status": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ]
      }
    },
    {
      "collection_name": "users",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"_id": {"type": "string"}},
              {"name": {"type": "string"}},
              {"profile.avatar": {"type": "string"}},
              {"product_reviews": {"type": "relation", "relate_collection": "product_reviews"}}
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {"_id": {"type": "string"}},
              {"email": {"type": "string"}},
              {"name": {"type": "string"}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"email": {"type": "string"}},
              {"name": {"type": "string"}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string"}},
              {"lastLogin": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "default",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"email": {"type": "string", "pattern": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"}},
              {"profile.age": {"type": "number", "min": 13, "max": 120}},
              {"profile.avatar": {"type": "string", "pattern": "^https?://.*\\.(jpg|jpeg|png|gif)$"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"email": {"type": "string", "pattern": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"}},
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive", "suspended"]}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "user",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"email": {"type": "string", "pattern": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive"]}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"email": {"type": "string", "pattern": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"}},
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive", "suspended"]}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "user",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"profile.age": {"type": "number", "min": 13, "max": 120}},
              {"profile.interests": {"type": "object"}},
              {"profile.avatar": {"type": "string", "pattern": "^https?://.*\\.(jpg|jpeg|png|gif)$"}},
              {"profile.country": {"type": "string", "maxLength": 2}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"email": {"type": "string", "pattern": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"}},
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string", "enum": ["active", "inactive", "suspended"]}},
              {"lastLogin": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"email": {"type": "string"}},
              {"name": {"type": "string"}},
              {"profile": {"type": "object"}},
              {"status": {"type": "string"}},
              {"lastLogin": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ]
      }
    },
    {
      "collection_name": "orders",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"_id": {"type": "string"}},
              {"orderNumber": {"type": "string"}}
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {"_id": {"type": "string"}},
              {"orderNumber": {"type": "string"}},
              {"customerId": {"type": "string"}},
              {"items": {"type": "object"}},
              {"shippingAddress": {"type": "object"}},
              {"billingAddress": {"type": "object"}},
              {"payment.method": {"type": "string"}},
              {"payment.status": {"type": "string"}},
              {"payment.amount": {"type": "number"}},
              {"status": {"type": "string"}},
              {"orderDate": {"type": "string"}},
              {"shippedDate": {"type": "string"}},
              {"deliveredDate": {"type": "string"}},
              {"notes": {"type": "string"}},
              {"customer": {"type": "relation", "relate_collection": "users"}},
              {"payment.transactionId": {"type": "string"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"orderNumber": {"type": "string"}},
              {"customerId": {"type": "string"}},
              {"items": {"type": "object"}},
              {"shippingAddress": {"type": "object"}},
              {"billingAddress": {"type": "object"}},
              {"payment": {"type": "object"}},
              {"subtotal": {"type": "number"}},
              {"tax": {"type": "number"}},
              {"shipping": {"type": "number"}},
              {"discount": {"type": "number"}},
              {"totalAmount": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"status": {"type": "string"}},
              {"orderDate": {"type": "string"}},
              {"shippedDate": {"type": "string"}},
              {"deliveredDate": {"type": "string"}},
              {"notes": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "user",
            "patterns": [
              {"customerId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"items": {"type": "object", "minItems": 1}},
              {"shippingAddress": {"type": "object", "required": ["street", "city", "postalCode", "country"]}},
              {"billingAddress": {"type": "object"}},
              {"payment": {"type": "object", "required": ["method"], "properties": {"method": {"enum": ["credit_card", "paypal", "bank_transfer"]}}}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"orderNumber": {"type": "string", "pattern": "^ORD-[0-9]{8}$"}},
              {"customerId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"items": {"type": "object", "minItems": 1}},
              {"shippingAddress": {"type": "object", "required": ["street", "city", "postalCode", "country"]}},
              {"billingAddress": {"type": "object"}},
              {"payment": {"type": "object", "required": ["method", "status"], "properties": {"method": {"enum": ["credit_card", "paypal", "bank_transfer"]}, "status": {"enum": ["pending", "completed", "failed"]}}}},
              {"subtotal": {"type": "number", "min": 0}},
              {"tax": {"type": "number", "min": 0}},
              {"shipping": {"type": "number", "min": 0}},
              {"discount": {"type": "number", "min": 0}},
              {"totalAmount": {"type": "number", "min": 0}},
              {"currency": {"type": "string", "enum": ["USD", "EUR", "VND", "GBP"]}},
              {"status": {"type": "string", "enum": ["pending", "processing", "shipped", "delivered", "cancelled"]}},
              {"orderDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"notes": {"type": "string", "maxLength": 1000}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "user",
            "patterns": [
              {"shippingAddress": {"type": "object", "required": ["street", "city", "postalCode", "country"]}},
              {"billingAddress": {"type": "object"}},
              {"notes": {"type": "string", "maxLength": 500}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"orderNumber": {"type": "string", "pattern": "^ORD-[0-9]{8}$"}},
              {"customerId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"items": {"type": "object", "minItems": 1}},
              {"shippingAddress": {"type": "object", "required": ["street", "city", "postalCode", "country"]}},
              {"billingAddress": {"type": "object"}},
              {"payment": {"type": "object", "required": ["method", "status"], "properties": {"method": {"enum": ["credit_card", "paypal", "bank_transfer"]}, "status": {"enum": ["pending", "completed", "failed"]}}}},
              {"subtotal": {"type": "number", "min": 0}},
              {"tax": {"type": "number", "min": 0}},
              {"shipping": {"type": "number", "min": 0}},
              {"discount": {"type": "number", "min": 0}},
              {"totalAmount": {"type": "number", "min": 0}},
              {"currency": {"type": "string", "enum": ["USD", "EUR", "VND", "GBP"]}},
              {"status": {"type": "string", "enum": ["pending", "processing", "shipped", "delivered", "cancelled"]}},
              {"orderDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"shippedDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"deliveredDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"notes": {"type": "string", "maxLength": 1000}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "user",
            "patterns": [
              {"shippingAddress": {"type": "object"}},
              {"notes": {"type": "string", "maxLength": 500}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"status": {"type": "string", "enum": ["pending", "processing", "shipped", "delivered", "cancelled"]}},
              {"shippingAddress": {"type": "object"}},
              {"payment.status": {"type": "string", "enum": ["pending", "completed", "failed", "refunded"]}},
              {"shippedDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"deliveredDate": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$"}},
              {"notes": {"type": "string", "maxLength": 1000}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"orderNumber": {"type": "string"}},
              {"customerId": {"type": "string"}},
              {"items": {"type": "object"}},
              {"shippingAddress": {"type": "object"}},
              {"billingAddress": {"type": "object"}},
              {"payment": {"type": "object"}},
              {"subtotal": {"type": "number"}},
              {"tax": {"type": "number"}},
              {"shipping": {"type": "number"}},
              {"discount": {"type": "number"}},
              {"totalAmount": {"type": "number"}},
              {"currency": {"type": "string"}},
              {"status": {"type": "string"}},
              {"orderDate": {"type": "string"}},
              {"shippedDate": {"type": "string"}},
              {"deliveredDate": {"type": "string"}},
              {"notes": {"type": "string"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ]
      }
    },
    {
      "collection_name": "categories",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"_id": {"type": "string"}},
              {"name": {"type": "string"}},
              {"slug": {"type": "string"}},
              {"description": {"type": "string"}},
              {"parentId": {"type": "string"}},
              {"image": {"type": "string"}},
              {"sortOrder": {"type": "number"}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string"}},
              {"parent": {"type": "relation", "relate_collection": "categories"}},
              {"children": {"type": "relation", "relate_collection": "categories"}},
              {"products": {"type": "relation", "relate_collection": "products"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"name": {"type": "string"}},
              {"slug": {"type": "string"}},
              {"description": {"type": "string"}},
              {"parentId": {"type": "string"}},
              {"image": {"type": "string"}},
              {"sortOrder": {"type": "number"}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string"}},
              {"seo": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "admin",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"slug": {"type": "string", "pattern": "^[a-z0-9-]+$"}},
              {"description": {"type": "string", "maxLength": 500}},
              {"parentId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"image": {"type": "string", "pattern": "^https?://.*\\.(jpg|jpeg|png|gif|webp)$"}},
              {"sortOrder": {"type": "number", "min": 0}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string", "enum": ["active", "inactive"]}},
              {"seo": {"type": "object"}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "admin",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"slug": {"type": "string", "pattern": "^[a-z0-9-]+$"}},
              {"description": {"type": "string", "maxLength": 500}},
              {"parentId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"image": {"type": "string", "pattern": "^https?://.*\\.(jpg|jpeg|png|gif|webp)$"}},
              {"sortOrder": {"type": "number", "min": 0}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string", "enum": ["active", "inactive"]}},
              {"seo": {"type": "object"}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "admin",
            "patterns": [
              {"name": {"type": "string", "minLength": 2, "maxLength": 100}},
              {"description": {"type": "string", "maxLength": 500}},
              {"image": {"type": "string", "pattern": "^https?://.*\\.(jpg|jpeg|png|gif|webp)$"}},
              {"sortOrder": {"type": "number", "min": 0}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string", "enum": ["active", "inactive"]}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"name": {"type": "string"}},
              {"slug": {"type": "string"}},
              {"description": {"type": "string"}},
              {"parentId": {"type": "string"}},
              {"image": {"type": "string"}},
              {"sortOrder": {"type": "number"}},
              {"featured": {"type": "boolean"}},
              {"status": {"type": "string"}},
              {"seo": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ]
      }
    },
    {
      "collection_name": "product_reviews",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"rating": {"type": "number"}},
              {"content": {"type": "string"}},
              {"helpful": {"type": "object"}},
              {"images": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"product.name": {"type": "string"}},
              {"user.name": {"type": "string"}},
              {"user.profile.avatar": {"type": "string"}}
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"userId": {"type": "string"}},
              {"rating": {"type": "number"}},
              {"title": {"type": "string"}},
              {"content": {"type": "string"}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}},
              {"status": {"type": "string"}},
              {"images": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}},
              {"product": {"type": "relation", "relate_collection": "products"}},
              {"user": {"type": "relation", "relate_collection": "users"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"userId": {"type": "string"}},
              {"rating": {"type": "number"}},
              {"title": {"type": "string"}},
              {"content": {"type": "string"}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}},
              {"status": {"type": "string"}},
              {"images": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "user",
            "patterns": [
              {"productId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"userId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"rating": {"type": "number", "min": 1, "max": 5}},
              {"title": {"type": "string", "minLength": 5, "maxLength": 100}},
              {"content": {"type": "string", "minLength": 20, "maxLength": 2000}},
              {"images": {"type": "object", "maxItems": 5}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"productId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"userId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"rating": {"type": "number", "min": 1, "max": 5}},
              {"title": {"type": "string", "minLength": 5, "maxLength": 100}},
              {"content": {"type": "string", "minLength": 20, "maxLength": 2000}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}},
              {"status": {"type": "string", "enum": ["pending", "approved", "rejected"]}},
              {"images": {"type": "object", "maxItems": 5}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "user",
            "patterns": [
              {"rating": {"type": "number", "min": 1, "max": 5}},
              {"title": {"type": "string", "minLength": 5, "maxLength": 100}},
              {"content": {"type": "string", "minLength": 20, "maxLength": 2000}},
              {"images": {"type": "object", "maxItems": 5}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"productId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"userId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"rating": {"type": "number", "min": 1, "max": 5}},
              {"title": {"type": "string", "minLength": 5, "maxLength": 100}},
              {"content": {"type": "string", "minLength": 20, "maxLength": 2000}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}},
              {"status": {"type": "string", "enum": ["pending", "approved", "rejected"]}},
              {"images": {"type": "object", "maxItems": 5}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "user",
            "patterns": [
              {"helpful": {"type": "object"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"status": {"type": "string", "enum": ["pending", "approved", "rejected"]}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "user",
            "patterns": [
              {"reviews": {"type": "object"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"userId": {"type": "string"}},
              {"rating": {"type": "number"}},
              {"title": {"type": "string"}},
              {"content": {"type": "string"}},
              {"verified": {"type": "boolean"}},
              {"helpful": {"type": "object"}},
              {"status": {"type": "string"}},
              {"images": {"type": "object"}},
              {"createdAt": {"type": "string"}},
              {"updatedAt": {"type": "string"}}
            ]
          }
        ]
      }
    },
    {
      "collection_name": "product_categories",
      "rbac_config": {
        "GET": [
          {
            "user_role": "default",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"categoryId": {"type": "string"}},
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number"}},
              {"product": {"type": "relation", "relate_collection": "products"}},
              {"category": {"type": "relation", "relate_collection": "categories"}}
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"categoryId": {"type": "string"}},
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number"}},
              {"createdAt": {"type": "string"}}
            ]
          }
        ],
        "POST": [
          {
            "user_role": "admin",
            "patterns": [
              {"productId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"categoryId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number", "min": 0}}
            ]
          }
        ],
        "PUT": [
          {
            "user_role": "admin",
            "patterns": [
              {"productId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"categoryId": {"type": "string", "pattern": "^[a-zA-Z0-9]{24}$"}},
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number", "min": 0}}
            ]
          }
        ],
        "PATCH": [
          {
            "user_role": "admin",
            "patterns": [
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number", "min": 0}}
            ]
          }
        ],
        "DELETE": [
          {
            "user_role": "admin",
            "patterns": [
              {"_id": {"type": "string"}},
              {"productId": {"type": "string"}},
              {"categoryId": {"type": "string"}},
              {"isPrimary": {"type": "boolean"}},
              {"sortOrder": {"type": "number"}},
              {"createdAt": {"type": "string"}}
            ]
          }
        ]
      }
    }
  ]
}
