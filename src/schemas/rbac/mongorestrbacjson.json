{
  "name": "mongorest_rbac_config",
  "version": "2.0.0",
  "description": "RBAC configuration aligned with MongoREST collection schemas",
  "collections": [
    {
      "collection_name": "products",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              {
                "sku": "field"
              },
              {
                "name": "field"
              },
              {
                "description": "field"
              },
              {
                "category": "field"
              },
              {
                "subcategory": "field"
              },
              {
                "price": "field"
              },
              {
                "currency": "field"
              },
              {
                "ratings": "field"
              },
              {
                "status": "field"
              }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "sku": "field"
              },
              {
                "name": "field"
              },
              {
                "description": "field"
              },
              {
                "category": "field"
              },
              {
                "subcategory": "field"
              },
              {
                "price": "field"
              },
              {
                "currency": "field"
              },
              {
                "inventory.quantity": "field"
              },
              {
                "images": "field"
              },
              {
                "tags": "field"
              },
              {
                "specifications": "field"
              },
              {
                "ratings": "field"
              },
              {
                "status": "field"
              },
              {
                "createdAt": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "sku": "field"
              },
              {
                "name": "field"
              },
              {
                "category": "field"
              },
              {
                "subcategory": "field"
              },
              {
                "price": "field"
              },
              {
                "currency": "field"
              },
              {
                "inventory": "field"
              },
              {
                "ratings": "field"
              },
              {
                "status": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "updatedAt": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "ratings": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "users",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "name": "field"
              },
              {
                "profile.avatar": "field"
              }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "email": "field"
              },
              {
                "name": "field"
              },
              {
                "profile": "field"
              },
              {
                "status": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "name": "field"
              },
              {
                "profile.age": "field"
              },
              {
                "profile.country": "field"
              },
              {
                "profile.interests": "field"
              },
              {
                "status": "field"
              },
              {
                "lastLogin": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "email": "field"
              },
              {
                "profile.avatar": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "name": "field"
              },
              {
                "profile.age": "field"
              },
              {
                "profile.interests": "field"
              },
              {
                "profile.avatar": "field"
              },
              {
                "email": "field"
              },
              {
                "profile.country": "field"
              },
              {
                "status": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "orders",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "orderNumber": "field"
              },
              {
                "customerId": "field"
              },
              {
                "items": "field"
              },
              {
                "shippingAddress": "field"
              },
              {
                "billingAddress": "field"
              },
              {
                "payment.method": "field"
              },
              {
                "payment.status": "field"
              },
              {
                "payment.amount": "field"
              },
              {
                "subtotal": "field"
              },
              {
                "tax": "field"
              },
              {
                "shipping": "field"
              },
              {
                "discount": "field"
              },
              {
                "totalAmount": "field"
              },
              {
                "currency": "field"
              },
              {
                "status": "field"
              },
              {
                "orderDate": "field"
              },
              {
                "shippedDate": "field"
              },
              {
                "deliveredDate": "field"
              },
              {
                "notes": "field"
              },
              {
                "customer": "field"
              },
              {
                "payment.transactionId": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "orderNumber": "field"
              },
              {
                "customerId": "field"
              },
              {
                "items": "field"
              },
              {
                "payment.method": "field"
              },
              {
                "payment.status": "field"
              },
              {
                "payment.amount": "field"
              },
              {
                "subtotal": "field"
              },
              {
                "tax": "field"
              },
              {
                "shipping": "field"
              },
              {
                "discount": "field"
              },
              {
                "totalAmount": "field"
              },
              {
                "currency": "field"
              },
              {
                "status": "field"
              },
              {
                "orderDate": "field"
              },
              {
                "shippedDate": "field"
              },
              {
                "deliveredDate": "field"
              },
              {
                "customer._id": "field"
              },
              {
                "customer.name": "field"
              },
              {
                "customer.profile.country": "field"
              },
              {
                "shippingAddress": "field"
              },
              {
                "billingAddress": "field"
              },
              {
                "payment.transactionId": "field"
              },
              {
                "notes": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "shippingAddress": "field"
              },
              {
                "billingAddress": "field"
              },
              {
                "notes": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "categories",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "name": "field"
              },
              {
                "slug": "field"
              },
              {
                "description": "field"
              },
              {
                "parentId": "field"
              },
              {
                "image": "field"
              },
              {
                "sortOrder": "field"
              },
              {
                "featured": "field"
              },
              {
                "status": "field"
              },
              {
                "parent": "field"
              },
              {
                "children": "field"
              },
              {
                "products": "field"
              }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "name": "field"
              },
              {
                "slug": "field"
              },
              {
                "description": "field"
              },
              {
                "parentId": "field"
              },
              {
                "image": "field"
              },
              {
                "sortOrder": "field"
              },
              {
                "featured": "field"
              },
              {
                "status": "field"
              },
              {
                "seo": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "updatedAt": "field"
              },
              {
                "parent": "field"
              },
              {
                "children": "field"
              },
              {
                "products": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "product_reviews",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "productId": "field"
              },
              {
                "rating": "field"
              },
              {
                "content": "field"
              },
              {
                "helpful": "field"
              },
              {
                "images": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "product.name": "field"
              },
              {
                "user.name": "field"
              },
              {
                "user.profile.avatar": "field"
              }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "productId": "field"
              },
              {
                "userId": "field"
              },
              {
                "rating": "field"
              },
              {
                "title": "field"
              },
              {
                "content": "field"
              },
              {
                "verified": "field"
              },
              {
                "helpful": "field"
              },
              {
                "status": "field"
              },
              {
                "images": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "updatedAt": "field"
              },
              {
                "product": "field"
              },
              {
                "user": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "productId": "field"
              },
              {
                "userId": "field"
              },
              {
                "rating": "field"
              },
              {
                "title": "field"
              },
              {
                "content": "field"
              },
              {
                "verified": "field"
              },
              {
                "helpful": "field"
              },
              {
                "status": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "updatedAt": "field"
              },
              {
                "product._id": "field"
              },
              {
                "product.name": "field"
              },
              {
                "product.sku": "field"
              },
              {
                "user._id": "field"
              },
              {
                "user.name": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "productId": "field"
              },
              {
                "rating": "field"
              },
              {
                "title": "field"
              },
              {
                "content": "field"
              },
              {
                "images": "field"
              },
              {
                "userId": "field"
              },
              {
                "verified": "field"
              },
              {
                "helpful": "field"
              },
              {
                "status": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "status": "field"
              },
              {
                "helpful": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "reviews": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ]
      }
    },
    {
      "collection_name": "product_categories",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "productId": "field"
              },
              {
                "categoryId": "field"
              },
              {
                "isPrimary": "field"
              },
              {
                "sortOrder": "field"
              },
              {
                "product": "field"
              },
              {
                "category": "field"
              }
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              {
                "_id": "field"
              },
              {
                "productId": "field"
              },
              {
                "categoryId": "field"
              },
              {
                "isPrimary": "field"
              },
              {
                "sortOrder": "field"
              },
              {
                "createdAt": "field"
              },
              {
                "product": "field"
              },
              {
                "category": "field"
              }
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              {
                "*": "field"
              }
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              {
                "*": "field"
              }
            ]
          }
        ]
      }
    }
  ],
  "rbac_features": {
    "pattern_syntax": {
      "field": "field",
      "all_fields": "*"
    },
    "permission_inheritance": {
      "enabled": true,
      "hierarchy": [
        "default",
        "user",
        "analyst",
        "admin",
        "dev"
      ]
    },
    "dynamic_permissions": {
      "enabled": true,
      "context_aware": true,
      "runtime_evaluation": true
    }
  }
}