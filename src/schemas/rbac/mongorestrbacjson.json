{
  "name": "mongorest_rbac_config",
  "version": "2.0.0",
  "description": "RBAC configuration aligned with MongoREST collection schemas",
  "collections": [
    {
      "collection_name": "products",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              "sku",
              "name",
              "description",
              "category",
              "subcategory",
              "price",
              "currency",
              "ratings.*",
              "status",
              "!specifications.*",
              "!inventory.*",
              "look_"
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              "_id",
              "sku",
              "name",
              "description",
              "category",
              "subcategory",
              "price",
              "currency",
              "inventory.quantity",
              "images",
              "tags",
              "specifications.*",
              "ratings.*",
              "status",
              "createdAt",
              "!inventory.reserved",
              "!inventory.lowStockThreshold",
              "product_reviews~"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "_id",
              "sku",
              "name",
              "category",
              "subcategory",
              "price",
              "currency",
              "inventory.*",
              "ratings.*",
              "status",
              "createdAt",
              "updatedAt",
              "orderItems.*",
              "!specifications.internal.*",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": [
              "ratings.*",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "users",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              "_id",
              "name",
              "profile.avatar",
              "product_reviews~"
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              "_id",
              "email.@self",
              "name.@self",
              "profile.@self.*",
              "status.@self",
              "lastLogin.@self",
              "createdAt.@self",
              "updatedAt.@self",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "_id",
              "name",
              "profile.age",
              "profile.country",
              "profile.interests",
              "status",
              "lastLogin",
              "createdAt",
              "!email",
              "!profile.avatar",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              "name.@self",
              "profile.@self.age",
              "profile.@self.interests",
              "profile.@self.avatar",
              "!email.@self",
              "!profile.@self.country",
              "!status.@self",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "orders",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              "_id.@self",
              "orderNumber.@self",
              "customerId.@self",
              "items.@self.*",
              "shippingAddress.@self.*",
              "billingAddress.@self.*",
              "payment.@self.method",
              "payment.@self.status",
              "payment.@self.amount",
              "subtotal.@self",
              "tax.@self",
              "shipping.@self",
              "discount.@self",
              "totalAmount.@self",
              "currency.@self",
              "status.@self",
              "orderDate.@self",
              "shippedDate.@self",
              "deliveredDate.@self",
              "notes.@self",
              "customer.@self.*",
              "!payment.@self.transactionId",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "_id",
              "orderNumber",
              "customerId",
              "items.*",
              "payment.method",
              "payment.status",
              "payment.amount",
              "subtotal",
              "tax",
              "shipping",
              "discount",
              "totalAmount",
              "currency",
              "status",
              "orderDate",
              "shippedDate",
              "deliveredDate",
              "customer._id",
              "customer.name",
              "customer.profile.country",
              "!shippingAddress.*",
              "!billingAddress.*",
              "!payment.transactionId",
              "!notes",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              "shippingAddress.@self.*",
              "billingAddress.@self.*",
              "notes.@self",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "categories",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              "_id",
              "name",
              "slug",
              "description",
              "parentId",
              "image",
              "sortOrder",
              "featured",
              "status",
              "parent.*",
              "children.*",
              "products.*",
              "look_"
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              "_id",
              "name",
              "slug",
              "description",
              "parentId",
              "image",
              "sortOrder",
              "featured",
              "status",
              "seo.*",
              "createdAt",
              "updatedAt",
              "parent.*",
              "children.*",
              "products.*",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": []
          }
        ]
      }
    },
    {
      "collection_name": "product_reviews",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              "_id",
              "productId",
              "rating",
              "content",
              "helpful.*",
              "images",
              "createdAt",
              "product.name",
              "user.name",
              "user.profile.avatar",
              "look_"
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              "_id",
              "productId",
              "userId.@self",
              "rating",
              "title",
              "content",
              "verified",
              "helpful.*",
              "status.@self",
              "images",
              "createdAt",
              "updatedAt",
              "product.*",
              "user.@self.*",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "_id",
              "productId",
              "userId",
              "rating",
              "title",
              "content",
              "verified",
              "helpful.*",
              "status",
              "createdAt",
              "updatedAt",
              "product._id",
              "product.name",
              "product.sku",
              "user._id",
              "user.name",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              "productId",
              "rating",
              "title",
              "content",
              "images",
              "!userId",
              "!verified",
              "!helpful.*",
              "!status",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "status",
              "helpful.*",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": [
              "reviews.@self.*",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ]
      }
    },
    {
      "collection_name": "product_categories",
      "rbac_config": {
        "read": [
          {
            "user_role": "default",
            "patterns": [
              "_id",
              "productId",
              "categoryId",
              "isPrimary",
              "sortOrder",
              "product.*",
              "category.*",
              "look_"
            ]
          },
          {
            "user_role": "user",
            "patterns": [
              "_id",
              "productId",
              "categoryId",
              "isPrimary",
              "sortOrder",
              "createdAt",
              "product.*",
              "category.*",
              "look_"
            ]
          },
          {
            "user_role": "analyst",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "write": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ],
        "delete": [
          {
            "user_role": "default",
            "patterns": []
          },
          {
            "user_role": "user",
            "patterns": []
          },
          {
            "user_role": "analyst",
            "patterns": []
          },
          {
            "user_role": "admin",
            "patterns": [
              "*",
              "look_"
            ]
          },
          {
            "user_role": "dev",
            "patterns": [
              "*",
              "look_"
            ]
          }
        ]
      }
    }
  ],
  "rbac_features": {
    "pattern_syntax": {
      "wildcard": "*",
      "deep_wildcard": "**",
      "negation": "!field.*",
      "self_reference": "@self",
      "team_reference": "@team",
      "array_slicing": "field[0:5].*",
      "conditional_filters": "status=eq.approved"
    },
    "permission_inheritance": {
      "enabled": true,
      "hierarchy": ["default", "user", "analyst", "admin", "dev"]
    },
    "dynamic_permissions": {
      "enabled": true,
      "context_aware": true,
      "runtime_evaluation": true
    }
  },
  "role_definitions": {
    "default": {
      "description": "Anonymous/guest users",
      "level": 0,
      "inherits_from": null
    },
    "user": {
      "description": "Authenticated regular users",
      "level": 1,
      "inherits_from": "default"
    },
    "analyst": {
      "description": "Data analysts and reporting users",
      "level": 2,
      "inherits_from": "user"
    },
    "admin": {
      "description": "System administrators",
      "level": 3,
      "inherits_from": "analyst"
    },
    "dev": {
      "description": "Developers with special access",
      "level": 3,
      "inherits_from": "analyst"
    }
  }
}